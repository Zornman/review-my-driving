<div class="register-container">
  <div class="register-hero">
    <div class="hero-content">
      <h1 class="hero-title">Create Account</h1>
      <p class="hero-subtitle">
        Please fill out the fields with your information. We only collect whatâ€™s necessary for our services to function.
      </p>
    </div>
  </div>

  <div class="form-wrapper">
    <div class="form-card">
      <form [formGroup]="form" (ngSubmit)="signUpWithEmail()">
        <div class="form-grid">
          <!-- Email Field (full width like Contact) -->
          <div class="form-field full-width">
            <mat-form-field appearance="outline">
              <mat-label>Email Address</mat-label>
              <input
                matInput
                formControlName="email"
                type="email"
                autocomplete="email"
                required
              />
              <mat-icon matPrefix>email</mat-icon>
              <mat-error *ngIf="form.get('email')?.invalid && form.get('email')?.touched">
                <span *ngIf="form.get('email')?.hasError('required')">Email is required.</span>
                <span *ngIf="form.get('email')?.hasError('email')">Please enter a valid email.</span>
              </mat-error>
            </mat-form-field>
          </div>

          <!-- First Name -->
          <div class="form-field">
            <mat-form-field appearance="outline">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="firstName" autocomplete="given-name" required />
              <mat-icon matPrefix>person</mat-icon>
              <mat-error *ngIf="form.get('firstName')?.invalid && form.get('firstName')?.touched">
                First name is required.
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Last Name -->
          <div class="form-field">
            <mat-form-field appearance="outline">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="lastName" autocomplete="family-name" required />
              <mat-icon matPrefix>person_outline</mat-icon>
              <mat-error *ngIf="form.get('lastName')?.invalid && form.get('lastName')?.touched">
                Last name is required.
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Password -->
          <div class="form-field">
            <mat-form-field appearance="outline">
              <mat-label>Password</mat-label>
              <input
                matInput
                formControlName="password"
                [type]="hidePassword ? 'password' : 'text'"
                autocomplete="new-password"
                required
              />
              <mat-icon matPrefix>lock</mat-icon>

              <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="hidePassword = !hidePassword"
                aria-label="Toggle password visibility"
                class="button-suffix-icon"
              >
                <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>

              <mat-error *ngIf="form.get('password')?.invalid && form.get('password')?.touched">
                <span *ngIf="form.get('password')?.hasError('required')">Password is required.</span>
                <span *ngIf="form.get('password')?.hasError('minlength')">Password must be at least 8 characters long.</span>
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Confirm Password -->
          <div class="form-field">
            <mat-form-field appearance="outline">
              <mat-label>Confirm Password</mat-label>
              <input
                matInput
                formControlName="confirmPassword"
                [type]="hideConfirmPassword ? 'password' : 'text'"
                autocomplete="new-password"
                required
              />
              <mat-icon matPrefix>lock_outline</mat-icon>

              <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="hideConfirmPassword = !hideConfirmPassword"
                aria-label="Toggle confirm password visibility"
                class="button-suffix-icon"
              >
                <mat-icon>{{ hideConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
              </button>

              <mat-error
                *ngIf="(form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched) || (form.hasError('passwordsMismatch') && form.get('confirmPassword')?.touched)"
              >
                <span *ngIf="form.get('confirmPassword')?.hasError('required')">Please confirm your password.</span>
                <span *ngIf="form.hasError('passwordsMismatch')">Passwords do not match.</span>
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Server / Auth errors -->
          <div class="form-field full-width" *ngIf="errorMessage">
            <div class="auth-error">
              {{ errorMessage }}
            </div>
          </div>

          <!-- Primary submit -->
          <div class="form-field full-width submit-section">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="form.invalid || isSubmitting"
              class="submit-button"
            >
              <mat-icon *ngIf="!isSubmitting">person_add</mat-icon>
              <mat-spinner *ngIf="isSubmitting" diameter="20"></mat-spinner>
              {{ isSubmitting ? 'Creating...' : 'Create Account' }}
            </button>
          </div>

          <!-- Divider + Google -->
          <div class="form-field full-width">
            <div class="auth-divider">
              <span>or</span>
            </div>

            <button
              mat-stroked-button
              type="button"
              class="google-button icon-button"
              (click)="signUpWithGoogle()"
              [disabled]="isSubmitting"
            >
              <img src="assets/images/Google.png" alt="Google Logo" width="20" height="20" />
              <span>{{ isSubmitting ? 'Please wait...' : 'Continue with Google' }}</span>
            </button>

            <div class="auth-alt">
              <span>Already have an account? <a routerLink="/login">Login</a></span>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>