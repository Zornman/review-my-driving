.page {
	padding: 6px 0 20px;
}

/* =========================
   Theme-ish tokens (keep lightweight)
   ========================= */
:host {
	--mq-surface: var(--mdc-theme-surface);
	--mq-on-surface: var(--mat-table-row-item-label-text-color, var(--mdc-theme-on-surface));
	--mq-primary: var(--mdc-theme-primary);
	--mq-secondary: var(--mdc-theme-secondary);

	/* Tertiary: neutral ink tint derived from on-surface */
	--mq-tertiary: color-mix(in srgb, var(--mq-on-surface) 12%, transparent);

	/* Derived neutrals */
	--mq-border: color-mix(in srgb, var(--mq-on-surface) 14%, transparent);
	--mq-muted: color-mix(in srgb, var(--mq-on-surface) 72%, transparent);
	--mq-muted-2: color-mix(in srgb, var(--mq-on-surface) 58%, transparent);

	/* Surfaces */
	--mq-surface-2: color-mix(in srgb, var(--mq-tertiary) 55%, var(--mq-surface));
	--mq-hover: color-mix(in srgb, var(--mq-secondary) 14%, transparent);
	--mq-selected: color-mix(in srgb, var(--mq-primary) 10%, transparent);

	/* Explicit panel surface for expanded rows */
	--mq-panel: var(--mq-surface);
}

:host-context(body.dark-mode) {
	--mq-border: color-mix(in srgb, var(--mq-on-surface) 18%, transparent);
	--mq-hover: color-mix(in srgb, var(--mq-secondary) 18%, transparent);
	--mq-selected: color-mix(in srgb, var(--mq-primary) 14%, transparent);
	background: var(--mq-panel) !important;
	color: var(--mq-on-surface) !important;
}

:host-context(body.light-mode) {
	/* Match the TDM “panel” behavior for expanded rows */
	--mq-panel: #ffffff;
}

.header {
	display: flex;
	align-items: flex-start;
	justify-content: space-between;
	gap: 12px;
	margin: 6px 0 14px;
}

.title {
	margin: 0;
}

.subtitle {
	margin: 4px 0 0;
	opacity: 0.8;
}

.card {
	border-radius: 14px;
}

.filters {
	display: grid;
	grid-template-columns: 220px 1fr;
	gap: 12px;
	align-items: center;
	margin-bottom: 10px;
}

.filter,
.search {
	width: 100%;
}

.table-wrap {
	overflow: auto;
	background: transparent;
	border-radius: 0;
}

.mono {
	font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

.pill {
	display: inline-flex;
	align-items: center;
	padding: 2px 10px;
	border-radius: 999px;
	font-size: 12px;
	border: 1px solid var(--mq-border);
	background: var(--mq-tertiary);
	color: var(--mq-on-surface);
	text-transform: capitalize;
}

.pill.assigned {
	background: color-mix(in srgb, var(--mq-secondary) 18%, transparent);
	border-color: color-mix(in srgb, var(--mq-secondary) 32%, transparent);
}

.pill.unassigned {
	background: var(--mq-tertiary);
	border-color: var(--mq-border);
}

.actions {
	display: flex;
	gap: 8px;
	justify-content: flex-end;
	align-items: center;
	white-space: nowrap;
}

.loading {
	display: flex;
	align-items: center;
	gap: 10px;
	padding: 12px 0 2px;
}

.empty {
	padding: 18px 4px;
	text-align: center;
}

.empty-title {
	font-weight: 600;
}

.empty-subtitle {
	color: var(--mq-muted);
}

.hint {
	padding-top: 10px;
	color: var(--mq-muted);
}

/* =========================
   Expandable rows (TDM-style)
   ========================= */
.mq-table {
	width: 100%;
	background: transparent;
}

/* Keep header + cell text aligned with theme */
.mq-table .mat-mdc-header-cell,
.mq-table .mat-header-cell,
.mq-table .mat-mdc-cell,
.mq-table .mat-cell {
	color: var(--mq-on-surface);
	padding: 10px 14px;
}

.mq-header-row {
	background: var(--mq-surface-2);
	border-bottom: 1px solid var(--mq-border);
}

.mq-row {
	cursor: pointer;
	transition: background-color 120ms ease;

	&:hover {
		background: var(--mq-hover);
	}

	&.is-expanded {
		background: var(--mq-selected);
	}
}

.mq-expand-col {
	max-width: 60px !important;
	text-align: center;
}

.mq-expand-btn {
	width: 40px;
	height: 40px;
}

.mq-expand-icon {
	transition: transform 140ms ease;
	transform: rotate(0deg);
	color: var(--mq-primary);

	&.is-expanded {
		transform: rotate(180deg);
	}
}

/* detail row + cell spans full width */
.mq-detail-row .mat-mdc-cell,
.mq-detail-row .mat-cell {
	width: 100% !important;
	flex: 1 1 100% !important;
	display: block !important;
	padding-left: 0 !important;
	padding-right: 0 !important;
	background: var(--mq-panel) !important;
	color: var(--mq-on-surface) !important;
}

.mq-expanded-cell {
	padding: 0 !important;
	border-bottom: none !important;
	background: var(--mq-panel) !important;
	color: var(--mq-on-surface) !important;
}

.mq-expanded {
	padding: 14px 16px;
	border-top: 1px solid var(--mq-border);
	background: var(--mq-panel) !important;
	color: var(--mq-on-surface) !important;

	@media (max-width: 576px) {
		padding: 12px;
	}
}

.mq-details {
	display: grid;
	grid-template-columns: repeat(4, minmax(0, 1fr));
	gap: 12px 16px;
	align-items: start;

	@media (max-width: 900px) {
		grid-template-columns: repeat(2, minmax(0, 1fr));
	}

	@media (max-width: 576px) {
		grid-template-columns: 1fr;
	}
}

.mq-detail__label {
	font-size: 0.78rem;
	text-transform: uppercase;
	letter-spacing: 0.06em;
	color: var(--mq-muted-2);
	margin-bottom: 4px;
}

.mq-detail__value {
	font-size: 0.95rem;
	overflow-wrap: anywhere;
}

.mq-actions {
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
	justify-content: center;
	margin-top: 14px;

	@media (max-width: 576px) {
		justify-content: stretch;

		button {
			flex: 1 1 calc(50% - 10px);
		}
	}

	@media (max-width: 380px) {
		button {
			flex: 1 1 100%;
		}
	}
}

/* =========================
   Responsive: hide columns, show in expanded grid
   ========================= */
.truck-column,
.created-at-column,
.assigned-at-column {
	@media screen and (max-width: 720px) {
		display: none;
	}
}

.mq-detail--truck-show-when-hidden,
.mq-detail--created-show-when-hidden,
.mq-detail--assigned-show-when-hidden {
	display: none;

	@media screen and (max-width: 720px) {
		display: block;
	}
}

/* Ensure header never overlays content (protect against global header styles) */
.mq-header {
    /* defend against any global `.header` sticky/fixed rules */
    position: static !important;
    top: auto !important;
    left: auto !important;
    right: auto !important;
    z-index: auto !important;

    display: flex; /* ensure layout is controlled here */
    align-items: center; /* keep button vertically centered */
    justify-content: space-between;
    gap: 12px;

    padding: 12px 12px; /* top/bottom padding so button isn't touching edges */
    border-radius: 14px;
    background: var(--mq-surface-2);
    border: 1px solid var(--mq-border);

    margin: 6px 0 14px; /* space before the card below */
    height: auto !important; /* background grows with content */
    min-height: 0 !important;
}

.mq-title {
    margin: 0;
    line-height: 1.2;
}

.mq-subtitle {
    margin: 6px 0 0;
    opacity: 0.85;
}

/* Mobile tweaks: stack + full-width button */
@media (max-width: 800px) {
    .mq-header {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
    }

    .mq-header > button[mat-stroked-button] {
        width: 100%;
        justify-content: center;
        margin-top: 10px;
    }

    .filters {
        grid-template-columns: 1fr;
    }

    /* existing mobile rules */
    .header {
        flex-direction: column;
        align-items: stretch;
        gap: 10px;
    }

	/* keep title/subtitle readable on small screens */
	.title {
		line-height: 1.2;
	}

	.subtitle {
		margin-top: 6px;
	}

	/* make the refresh button align nicely on mobile */
	.header > button[mat-stroked-button] {
		width: 100%;
		justify-content: center;
	}

	/* tighten action column on small screens; expanded row has nicer buttons anyway */
	.mq-actions-col {
		@media (max-width: 720px) {
			display: none;
		}
	}
}

/* If any ancestor sets overflow/position in a way that causes overlap, this helps keep layout stable */
.mq-page {
    position: relative;
}
